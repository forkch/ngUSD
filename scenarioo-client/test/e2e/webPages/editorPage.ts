'use strict';

import * as Utils from '../util/util';
import {by, element, ElementFinder} from 'protractor';

class EditorPage {

    private saveButton = element(by.id('save'));
    private saveSketchSuccessfulMessage = element(by.id('saveSketchSuccessfulMessage'));
    private issueNameTextField = element(by.id('issueName'));
    private issueAuthorTextField = element(by.id('issueAuthor'));
    private issueDescriptionTextField = element(by.id('issueDescription'));

    async enterSketchInformation(sketchName, author) {
        await this.issueNameTextField.clear();
        await this.issueNameTextField.sendKeys(sketchName);
        await this.issueAuthorTextField.clear();
        await this.issueAuthorTextField.sendKeys(author);
        await this.issueDescriptionTextField.clear();
        return this.issueDescriptionTextField.sendKeys('this issue was generated by e2e tests');
    }

    async clickSaveButton() {
        await expect(this.saveButton.isEnabled()).toBeTruthy();
        return this.saveButton.click();
    }

    async assertSaveButtonIsDisabled() {
        return expect(this.saveButton.isEnabled()).toBe(false);
    }

    async assertPageIsDisplayed() {
        return expect(this.saveButton.isDisplayed()).toBe(true);
    }

    async assertAuthorFieldIsEmpty() {
        return expect(this.issueAuthorTextField.getText()).toBe('');
    }

    async assertAuthorFieldIsSetTo(expectedAuthor) {
        return expect(this.issueAuthorTextField.getAttribute('value')).toBe(expectedAuthor);
    }

    async assertSaveSketchSuccessfulMessageIsNotPresent() {
        return expect(this.saveSketchSuccessfulMessage.isPresent()).toBe(false);
    }

    async assertSaveSketchSuccessfulMessageIsDisplayed() {
        await Utils.waitForElementVisible(this.saveSketchSuccessfulMessage);
        return expect(this.saveSketchSuccessfulMessage.isDisplayed()).toBe(true);
    }

}

export default new EditorPage();
