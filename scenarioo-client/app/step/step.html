<!-- scenarioo-client
Copyright (C) 2014, scenarioo.org Development Team

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->

<sc-breadcrumbs></sc-breadcrumbs>

<sc-step-not-found-div show-component="stepNotFound" response="httpResponse"></sc-step-not-found-div>

<sc-fallback-div show-component="fallback" step-identifier="stepIdentifier"></sc-fallback-div>

<div class="step-navigation row sc-space-bottom step-view col-sm-8">
    <div id="left">
        <!-- Title component -->
        <sc-title scenario-name="{{stepIdentifier.scenarioName | scHumanReadable}}" step-index="{{getCurrentStepIndexForDisplay()}}"></sc-title>
    </div>
    <div id="right">
        <!-- New Navigation -->
        <sc-progressbar *ngIf="!stepNotFound" [step-navigation]="stepNavigation" [step-statistics]="stepStatistics"></sc-progressbar>
    </div>
</div>

<!-- Navigation toolbar
<sc-step-navigation-toolbar step-navigation="stepNavigation" step-statistics="stepStatistics" step="step" page-name="pageName" linking-variable="stepShowMetadata" show-screen-annotations="showScreenAnnotations" hide-toolbar="stepNotFound"></sc-step-navigation-toolbar>
-->

<!-- screenshot and information -->
<sc-meta-data-panel linking-variable="stepShowMetadata" ng-hide="stepNotFound" class="step-view col-sm-12">
    <div class="pull-right">
        <sc-screen-annotations-button visibility-toggle="$ctrl.showScreenAnnotations"
                                      screen-annotations="$ctrl.step.screenAnnotations"></sc-screen-annotations-button>
    </div>

    <!-- details -->
    <div>
        <sc-detailarea class="panel panel-default" (valueChange)="collapsePanel($event)" [step-information-tree]="stepInformationTree" [related-issues]="relatedIssues" [scenario-labels]="scenarioLabels.labels" [use-case-labels]="useCaseLabels.labels" [step-labels]="step.stepDescription.labels.labels" [page-labels]="step.page.labels.labels" [label-configurations]="labelConfigurations" [metadata-information-tree]="metadataTree"></sc-detailarea>
    </div>

    <div ng-class="this.isPanelCollapsed ? 'sc-tabs col-sm-12' : 'sc-tabs col-sm-8'">

        <uib-tabset class="step-panes" active="activeTab">
            <uib-tab heading="Screenshot" id="screenshot-tab" ng-click="setDefaultTab()">
                <sc-annotated-screenshot screen-annotations="step.screenAnnotations" screen-shot-url="screenShotUrl"
                                         visibility-toggle="showScreenAnnotations"
                                         to-next-step-action="goStepForward()"></sc-annotated-screenshot>
            </uib-tab>
            <uib-tab heading="HTML" id="html-tab" ng-hide="!step.html.htmlSource" ng-click="setActiveTab(1)">
                <pre ng-bind="step.html.htmlSource" id="html-source"></pre>
            </uib-tab>

            <!-- Diff Viewer Step Comparison View -->
            <uib-tab id="comparison-tab" ng-click="setActiveTab(2)" ng-if="comparisonInfo.isDefined">

                <uib-tab-heading>
                    <span class="left">Comparison</span>
                    <div class="diff-info-wrapper">
                        <sc-diff-info-icon diff-info="step.diffInfo" element-type="screenshot"
                                           child-element-type="screenshot"></sc-diff-info-icon>
                    </div>
                </uib-tab-heading>
                <sc-comparison-view step="step" step-identifier="stepIdentifier" step-index="stepIndex"
                                    screen-shot-url="screenShotUrl"></sc-comparison-view>
            </uib-tab>

        </uib-tabset>
    </div>

</sc-meta-data-panel>
